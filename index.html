<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>해솔라라중학교 시험 대비 사이트</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&family=Jua&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
        }
        h1, h2, h3, .font-jua {
            font-family: 'Jua', sans-serif;
        }
        /* 탭 스타일 */
        .tab {
            transition: all 0.3s ease;
        }
        .tab.active {
            background-color: #4f46e5; /* indigo-600 */
            color: white;
            border-bottom-color: transparent;
        }
        .tab:not(.active):hover {
            background-color: #eef2ff; /* indigo-50 */
        }
        /* 라디오 버튼 커스텀 스타일 */
        .custom-radio {
            appearance: none;
            -webkit-appearance: none;
            width: 1.25rem;
            height: 1.25rem;
            border: 2px solid #6b7280;
            border-radius: 50%;
            outline: none;
            transition: all 0.2s;
            margin-right: 0.5rem;
            cursor: pointer;
            flex-shrink: 0;
        }
        .custom-radio:checked {
            background-color: #4f46e5;
            border-color: #4f46e5;
            box-shadow: 0 0 0 3px white, 0 0 0 5px #4f46e5;
        }
    </style>
</head>
<body class="bg-gray-100">

    <div id="app" class="container mx-auto p-4 max-w-4xl">
        <header class="text-center my-8">
            <h1 class="text-4xl font-jua text-indigo-600">해솔라라중학교 2학년 국어</h1>
            <h2 class="text-5xl font-jua text-gray-800 mt-2">기말고사 실전 테스트</h2>
        </header>

        <!-- 탭 메뉴 -->
        <div id="tab-container" class="flex flex-wrap border-b border-gray-300 mb-6">
            <!-- 탭은 JS로 생성 -->
        </div>

        <!-- 콘텐츠 영역 -->
        <main id="content-container" class="bg-white p-6 rounded-lg shadow-lg min-h-[500px]">
            <!-- 뷰는 JS로 렌더링 -->
        </main>
    </div>

    <script>
        // --- DOM Elements ---
        const app = document.getElementById('app');
        const tabContainer = document.getElementById('tab-container');
        const contentContainer = document.getElementById('content-container');

        // --- Quiz Data ---
        const allQuizzes = {
            chapter_1_1: { title: "1. (1) 엄마 걱정", questions: [ { question: "시에서 말하는 이, 즉 시인이 자신의 생각을 전달하기 위해 내세우는 대상을 무엇이라고 하나요?", options: ["독자", "화자", "청자"], correct: 1, explanation: "시에서 말하는 이를 '화자' 또는 '시적 화자'라고 합니다." }, { question: "이 시의 화자는 누구인가요?", options: ["어린 시절의 나", "시장에 간 엄마", "어른이 된 나"], correct: 2, explanation: "2연의 '지금도 내 눈시울을 뜨겁게 하는' 구절을 통해 어른이 된 화자가 과거를 회상하고 있음을 알 수 있습니다." }, { question: "화자가 처한 상황으로 가장 적절한 것은?", options: ["혼자 엄마를 기다림", "친구와 놀고 있음", "시장에서 장사함"], correct: 0, explanation: "화자는 시장에 간 엄마를 빈방에서 홀로 기다리고 있습니다." }, { question: "'열무 삼십 단을 이고' 시장에 간 엄마에 대한 화자의 주된 정서는?", options: ["자랑스러움", "안쓰러움과 그리움", "무관심"], correct: 1, explanation: "고된 삶을 사는 엄마에 대한 안쓰러움과, 돌아오지 않는 엄마에 대한 그리움이 주된 정서입니다." }, { question: "'찬밥처럼 방에 담겨'라는 표현이 의미하는 것은?", options: ["배가 고픔", "외롭게 홀로 남겨짐", "방이 매우 추움"], correct: 1, explanation: "아무도 돌보지 않는 외롭고 쓸쓸한 처지를 '찬밥'에 빗대어 표현했습니다." } /* ... 20 more questions */ ] },
            chapter_1_2: { title: "1. (2) 동백꽃", questions: [ { question: "소설에서 독자에게 이야기를 전달하는 이를 무엇이라고 하나요?", options: ["작가", "주인공", "서술자"], correct: 2, explanation: "소설 속에서 사건, 인물, 배경 등을 독자에게 이야기해주는 이를 '서술자'라고 합니다." }, { question: "<동백꽃>의 서술자는 누구인가요?", options: ["점순이", "나", "마을 사람"], correct: 1, explanation: "이 소설은 주인공인 '나'가 자신의 이야기를 직접 전달하는 1인칭 주인공 시점입니다." }, { question: "서술자인 '나'의 성격으로 가장 적절한 것은?", options: ["영리하고 눈치가 빠름", "순박하지만 눈치가 없음", "소심하고 내성적임"], correct: 1, explanation: "'나'는 점순이의 애정 표현을 괴롭힘으로 받아들이는 등 눈치가 없고 어수룩한 성격입니다." }, { question: "점순이가 '나'에게 감자를 준 진짜 이유는 무엇인가요?", options: ["'나'를 놀리기 위해", "'나'의 집이 가난해서", "'나'에게 호감이 있어서"], correct: 2, explanation: "감자는 '나'에 대한 점순이의 관심과 애정을 표현하는 매개체입니다." }, { question: "'나'가 점순이가 준 감자를 거절한 이유는 무엇인가요?", options: ["감자를 싫어해서", "배가 불러서", "점순이가 생색낸다고 생각해서"], correct: 2, explanation: "'느 집엔 이거 없지?'라는 점순이의 말에 자존심이 상해 감자를 거절했습니다." } /* ... 20 more questions */ ] },
            chapter_2_1: { title: "2. (1) 읽기의 생활화", questions: [ { question: "글쓴이가 중학교 2학년 때 했던 특별 활동은 무엇인가요?", options: ["도서반", "산악반", "미술반"], correct: 1, explanation: "담임 선생님이 산악반을 맡고 계셔서 자신의 취향과 상관없이 산악반 활동을 했습니다." }, { question: "글쓴이가 3학년 때 도서반을 선택한 이유는 무엇인가요?", options: ["책 읽기를 좋아해서", "몸을 많이 움직이지 않으려고", "선생님의 추천으로"], correct: 1, explanation: "산악반 경험에 비추어, 몸을 많이 움직이지 않는 특별 활동을 하고 싶었기 때문입니다." }, { question: "글쓴이가 도서반에서 처음 고른 책의 저자는 누구인가요?", options: ["김만중", "허균", "박지원"], correct: 2, explanation: "한자로 제목이 쓰여 있어 아이들이 손대지 않는 책 중 박지원의 책을 골랐습니다." }, { question: "글쓴이가 박지원의 소설을 거부감 없이 읽을 수 있었던 이유는 무엇인가요?", options: ["선생님이 재미있다고 해서", "무협지와 문체, 내용이 비슷해서", "친구가 강력 추천해서"], correct: 1, explanation: "이전에 무협지를 많이 읽어 예스러운 문체에 익숙했고, 내용 전개 방식도 비슷하게 느꼈기 때문입니다." }, { question: "글쓴이의 삶에 가장 큰 영향을 미친 독서 경험은 무엇인가요?", options: ["어릴 때 읽은 위인전", "중3 때 읽은 박지원의 소설", "고등학생 때 읽은 현대 소설"], correct: 1, explanation: "박지원의 소설을 읽은 경험이 현재 소설을 쓰는 계기가 되었다고 말했습니다." } /* ... 20 more questions */ ] },
            chapter_3_1: { title: "3. (1) 담화의 개념과 특성", questions: [ { question: "화자와 청자가 주고받는 발화의 연속체를 무엇이라고 하나요?", options: ["문장", "단어", "담화"], correct: 2, explanation: "담화는 화자와 청자가 특정 맥락 속에서 주고받는 발화나 글의 연속체입니다." }, { question: "발화들의 내용이 담화의 주제를 향해 밀접하게 연관되는 특성은 무엇인가요?", options: ["응집성", "통일성", "상황성"], correct: 1, explanation: "통일성은 내용이 하나의 주제로 긴밀하게 모이는 것을 의미합니다." }, { question: "담화를 구성하는 발화들이 형식적으로 긴밀하게 연결되는 특성은 무엇인가요?", options: ["통일성", "응집성", "문화성"], correct: 1, explanation: "응집성은 지시 표현, 접속 표현 등을 통해 문장들이 형식적으로 잘 연결되는 것을 의미합니다." }, { question: "화자와 청자의 관계, 시간과 장소, 의도 등 장면 자체와 관련된 맥락은 무엇인가요?", options: ["상황 맥락", "사회·문화적 맥락", "역사적 맥락"], correct: 0, explanation: "상황 맥락은 담화가 이루어지는 구체적인 장면과 관련된 요소들입니다." }, { question: "역사적 배경, 공동체의 가치, 문화 등과 관련된 맥락은 무엇인가요?", options: ["상황 맥락", "개인적 맥락", "사회·문화적 맥락"], correct: 2, explanation: "사회·문화적 맥락은 담화 참여자들이 공유하는 사회적, 문화적 배경을 의미합니다." } /* ... 20 more questions */ ] },
            chapter_4_1: { title: "4. (1) 먼 후일 / 독은 아름답다", questions: [ { question: "시를 읽을 때 느껴지는 말의 가락을 무엇이라고 하나요?", options: ["주제", "심상", "운율"], correct: 2, explanation: "운율은 시의 음악적 요소로, 반복을 통해 형성됩니다." }, { question: "표현하려는 내용을 실제 의미와 반대로 표현하는 방법을 무엇이라고 하나요?", options: ["역설", "반어", "풍자"], correct: 1, explanation: "반어는 속마음과 반대로 말하여 의미를 강조하는 표현법입니다." }, { question: "겉보기에는 모순되지만 그 속에 진실을 담고 있는 표현 방법은 무엇인가요?", options: ["반어", "역설", "대조"], correct: 1, explanation: "역설은 '소리 없는 아우성'처럼 논리적으로는 맞지 않지만 깊은 진실을 담고 있는 표현입니다." }, { question: "<먼 후일>의 주된 표현 방법은 무엇인가요?", options: ["역설", "풍자", "반어"], correct: 2, explanation: "'잊었노라'라는 말을 반복하여 '잊지 못한다'는 속마음을 강조하는 반어법이 사용되었습니다." }, { question: "<독은 아름답다>의 주된 표현 방법은 무엇인가요?", options: ["반어", "역설", "직유"], correct: 1, explanation: "'구린내가 향기롭다', '독은 아름답다'와 같이 모순된 표현을 통해 진리를 드러내는 역설법이 사용되었습니다." } /* ... 20 more questions */ ] },
            chapter_4_2: { title: "4. (2) 양반전", questions: [ { question: "인물의 부정적인 면이나 사회의 부조리를 간접적으로 비판하며 웃음을 유발하는 표현 방법은?", options: ["반어", "역설", "풍자"], correct: 2, explanation: "풍자는 비판 대상을 간접적으로 돌려 말하거나 우스꽝스럽게 표현하여 비판하는 방식입니다." }, { question: "<양반전>의 주된 비판 대상은 누구인가요?", options: ["평민", "상인", "양반 계층"], correct: 2, explanation: "이 작품은 양반의 경제적 무능, 허례허식, 횡포를 풍자적으로 비판합니다." }, { question: "마을의 부자가 양반 신분을 사려고 한 이유는 무엇인가요?", options: ["양반이 불쌍해서", "평민으로서 겪는 수모를 벗어나고 싶어서", "군수의 명령 때문에"], correct: 1, explanation: "부자는 돈이 많아도 양반에게 멸시당하는 현실을 벗어나 존귀한 대우를 받고 싶어 했습니다." }, { question: "첫 번째 매매 증서가 주로 다루고 있는 내용은 무엇인가요?", options: ["양반이 누릴 수 있는 특권", "양반이 지켜야 할 허례허식", "돈 버는 방법"], correct: 1, explanation: "첫 번째 증서에는 실생활과 동떨어진, 체면과 형식만 중시하는 양반의 행동 규범이 나열되어 있습니다." }, { question: "두 번째 증서의 내용을 들은 부자가 양반 되기를 포기하며 양반을 무엇이라고 말했나요?", options: ["신선", "도둑놈", "바보"], correct: 1, explanation: "백성을 수탈하는 양반의 특권이 '도둑놈'과 같다고 생각하며 양반 되기를 포기합니다." } /* ... 20 more questions */ ] },
            chapter_4_3: { title: "4. (3) 다양한 표현 활용", questions: [ { question: "글을 쓸 때 다양한 표현을 사용하면 얻는 효과가 아닌 것은?", options: ["내용을 참신하게 드러냄", "글의 분량을 늘릴 수 있음", "읽는 이의 기억에 오래 남음"], correct: 1, explanation: "다양한 표현은 글을 풍부하게 하지만, 불필요하게 분량을 늘리는 것이 목적은 아닙니다." }, { question: "다음 중 속담에 해당하는 것은?", options: ["발이 넓다", "가는 날이 장날이다", "그림의 떡"], correct: 1, explanation: "'가는 날이 장날이다'는 우연히 일이 잘 안 풀리는 상황을 이르는 속담입니다." }, { question: "다음 중 관용구에 해당하는 것은?", options: ["손이 크다", "원숭이도 나무에서 떨어진다", "하늘의 별 따기"], correct: 0, explanation: "'손이 크다'는 씀씀이가 후하다는 뜻의 관용구입니다." }, { question: "글쓴이가 슬기가 없어 외롭다는 마음을 무엇에 비유했나요?", options: ["참외", "김빠진 탄산음료", "그림자"], correct: 0, explanation: "'참 외롭다'는 말을 '참외'라는 단어를 이용해 재치있게 표현했습니다." }, { question: "'남을 지나치게 칭찬하거나 추어올려 주다'라는 의미의 관용구는?", options: ["발이 넓다", "손이 크다", "비행기를 태우다"], correct: 2, explanation: "실제 비행기를 태우는 것이 아니라, 칭찬으로 기분을 좋게 한다는 의미의 관용 표현입니다." } /* ... 20 more questions */ ] },
        };
        // Dummy data for remaining questions
        Object.keys(allQuizzes).forEach(key => {
            const chapter = allQuizzes[key];
            while (chapter.questions.length < 25) {
                chapter.questions.push({
                    question: `이것은 ${chapter.title}의 추가 문제입니다. 정답은 무엇일까요?`,
                    options: ["선택지 1", "선택지 2", "선택지 3"],
                    correct: 0,
                    explanation: "이것은 문제 수(25개)를 맞추기 위한 예시 문제입니다."
                });
            }
        });

        // --- App State ---
        let appState = {
            currentView: 'WELCOME', // WELCOME, TEST, RESULT
            activeTab: null,
            userName: '',
            userAnswers: [],
            currentQuestionIndex: 0,
            score: 0,
        };

        // --- Render Functions ---
        function render() {
            contentContainer.innerHTML = '';
            switch (appState.currentView) {
                case 'WELCOME':
                    renderWelcome();
                    break;
                case 'TEST':
                    renderTest();
                    break;
                case 'RESULT':
                    renderResult();
                    break;
            }
        }

        function renderWelcome() {
            contentContainer.innerHTML = `
                <div class="text-center">
                    <h3 class="text-3xl font-jua text-gray-700 mb-4">'${allQuizzes[appState.activeTab].title}' 실전 테스트</h3>
                    <p class="text-lg text-gray-600 mb-8">이름을 입력하고 테스트를 시작하세요.</p>
                    <div class="max-w-sm mx-auto">
                        <input type="text" id="name-input" class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:border-indigo-500 focus:outline-none text-center text-lg" placeholder="이름을 입력하세요" maxlength="10">
                        <button id="start-test-btn" class="w-full mt-4 bg-indigo-600 text-white font-bold py-3 px-8 rounded-lg text-xl hover:bg-indigo-700 transition-colors">
                            테스트 시작
                        </button>
                    </div>
                </div>
            `;
            document.getElementById('start-test-btn').addEventListener('click', startTest);
        }

        function renderTest() {
            const quizData = allQuizzes[appState.activeTab].questions;
            const questionData = quizData[appState.currentQuestionIndex];
            
            contentContainer.innerHTML = `
                <div class="mb-4">
                    <div class="flex justify-between items-center mb-2">
                        <h3 class="text-xl font-bold text-gray-800">문제 ${appState.currentQuestionIndex + 1}</h3>
                        <span class="text-gray-600 font-semibold">${appState.currentQuestionIndex + 1} / ${quizData.length}</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                        <div class="bg-indigo-600 h-2.5 rounded-full" style="width: ${((appState.currentQuestionIndex + 1) / quizData.length) * 100}%"></div>
                    </div>
                </div>
                <div class="bg-gray-50 p-6 rounded-lg mb-6">
                    <p class="text-xl text-gray-800 leading-relaxed">${questionData.question}</p>
                </div>
                <div id="options-list" class="space-y-3">
                    ${questionData.options.map((option, index) => `
                        <label class="flex items-center p-4 border-2 rounded-lg cursor-pointer hover:bg-indigo-50 hover:border-indigo-400 transition-all">
                            <input type="radio" name="option" value="${index}" class="custom-radio">
                            <span class="text-lg text-gray-700">${option}</span>
                        </label>
                    `).join('')}
                </div>
                <div class="flex justify-between mt-8">
                    <button id="prev-btn" class="bg-gray-300 text-gray-800 font-bold py-2 px-6 rounded-lg hover:bg-gray-400 transition-colors ${appState.currentQuestionIndex === 0 ? 'opacity-50 cursor-not-allowed' : ''}">이전</button>
                    ${appState.currentQuestionIndex === quizData.length - 1 
                        ? `<button id="submit-btn" class="bg-green-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-green-600 transition-colors">결과 보기</button>`
                        : `<button id="next-btn" class="bg-indigo-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-indigo-700 transition-colors">다음</button>`
                    }
                </div>
            `;

            // Event Listeners
            document.querySelectorAll('input[name="option"]').forEach(radio => {
                radio.addEventListener('change', (e) => {
                    appState.userAnswers[appState.currentQuestionIndex] = parseInt(e.target.value);
                });
            });

            if (appState.userAnswers[appState.currentQuestionIndex] !== undefined) {
                document.querySelector(`input[value="${appState.userAnswers[appState.currentQuestionIndex]}"]`).checked = true;
            }

            if (appState.currentQuestionIndex > 0) {
                document.getElementById('prev-btn').addEventListener('click', prevQuestion);
            }
            if (appState.currentQuestionIndex < quizData.length - 1) {
                document.getElementById('next-btn').addEventListener('click', nextQuestion);
            } else {
                document.getElementById('submit-btn').addEventListener('click', submitTest);
            }
        }
        
        function renderResult() {
            const quizData = allQuizzes[appState.activeTab].questions;
            let correctCount = 0;
            let resultHtml = '';

            quizData.forEach((q, index) => {
                const userAnswer = appState.userAnswers[index];
                const isCorrect = userAnswer === q.correct;
                if (isCorrect) correctCount++;
                else {
                    resultHtml += `
                        <div class="p-4 border-b">
                            <p class="font-bold text-lg text-gray-800 mb-2">Q${index + 1}. ${q.question}</p>
                            <p class="text-red-600">선택한 답: ${userAnswer !== undefined ? q.options[userAnswer] : '선택 안 함'}</p>
                            <p class="text-green-600 font-semibold">정답: ${q.options[q.correct]}</p>
                            <p class="text-gray-600 mt-2">해설: ${q.explanation || '해설이 없습니다.'}</p>
                        </div>
                    `;
                }
            });

            appState.score = Math.round((correctCount / quizData.length) * 100);

            contentContainer.innerHTML = `
                <div class="text-center">
                    <h3 class="text-3xl font-jua text-gray-700 mb-2">테스트 결과</h3>
                    <p class="text-xl text-gray-600 mb-4">${appState.userName}님의 점수는...</p>
                    <p class="text-7xl font-jua text-indigo-600 mb-8">${appState.score}점</p>
                    <button id="restart-btn" class="bg-indigo-600 text-white font-bold py-3 px-8 rounded-lg text-xl hover:bg-indigo-700 transition-colors">
                        다른 단원 풀어보기
                    </button>
                </div>
                <div class="mt-10">
                    <h4 class="text-2xl font-jua text-gray-800 mb-4 border-b-2 pb-2">오답 노트</h4>
                    ${resultHtml || '<p class="text-center text-gray-500 py-4">축하합니다! 모든 문제를 맞혔습니다!</p>'}
                </div>
            `;
            
            document.getElementById('restart-btn').addEventListener('click', () => {
                appState.currentView = 'WELCOME';
                render();
            });

            // Save score after rendering
            saveScoreToGoogleSheet(appState.userName, appState.score, allQuizzes[appState.activeTab].title);
        }

        // --- Event Handlers & Logic ---
        function handleTabClick(e) {
            const chapterKey = e.currentTarget.dataset.key;
            appState.activeTab = chapterKey;
            appState.currentView = 'WELCOME';
            
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            e.currentTarget.classList.add('active');
            
            render();
        }

        function startTest() {
            const nameInput = document.getElementById('name-input');
            const name = nameInput.value.trim();
            if (!name) {
                alert('이름을 입력해주세요.');
                nameInput.focus();
                return;
            }
            appState.userName = name;
            appState.userAnswers = [];
            appState.currentQuestionIndex = 0;
            appState.currentView = 'TEST';
            render();
        }

        function nextQuestion() {
            appState.currentQuestionIndex++;
            renderTest();
        }

        function prevQuestion() {
            appState.currentQuestionIndex--;
            renderTest();
        }

        function submitTest() {
            appState.currentView = 'RESULT';
            render();
        }

        // --- Google Sheets ---
        async function saveScoreToGoogleSheet(name, score, chapter) {
            const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbw6AXR4LFvlBr6isv6zyzQ5BKKjCyG-80mrH0ZTh9le-535NMPctCzf75aqnfWcZlpX/exec";
            const formData = new FormData();
            formData.append('timestamp', new Date().toLocaleString("ko-KR"));
            formData.append('name', name);
            formData.append('chapter', chapter);
            formData.append('score', score);

            try {
                await fetch(SCRIPT_URL, { method: 'POST', body: formData });
                console.log("점수 전송 성공!");
            } catch(e) {
                console.error("점수 전송 중 오류 발생:", e);
            }
        }

        // --- Initial Setup ---
        function setup() {
            Object.keys(allQuizzes).forEach(key => {
                const tab = document.createElement('button');
                tab.className = 'tab text-lg font-semibold py-3 px-5 border-b-2 border-transparent text-gray-600';
                tab.textContent = allQuizzes[key].title;
                tab.dataset.key = key;
                tab.addEventListener('click', handleTabClick);
                tabContainer.appendChild(tab);
            });
            
            // Activate the first tab by default
            const firstTab = tabContainer.querySelector('.tab');
            if (firstTab) {
                appState.activeTab = firstTab.dataset.key;
                firstTab.classList.add('active');
            }
            
            render();
        }

        setup();
    </script>
</body>
</html>
